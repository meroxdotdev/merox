---
import Link from '@/components/Link.astro'
import { Icon } from 'astro-icon/components'

interface Props {
  jobTitle: string
  worksFor: string
  /** URL to Lottie JSON (e.g. from import with ?url). Loaded by lottie-web, cacheable. */
  lottieSrc: string
}

const { jobTitle, worksFor, lottieSrc } = Astro.props
---

<div class="bento-card bento-identity">
  <div class="bento-identity__content">
    <p class="identity-role panel-title" aria-label={`${jobTitle} at ${worksFor}`}>
      <span class="identity-role__dot" aria-hidden="true"></span>
      {jobTitle}<span class="identity-role__sep" aria-hidden="true">/</span>{worksFor}
    </p>
    <h1 class="text-3xl sm:text-4xl md:text-5xl font-black tracking-tighter uppercase leading-[0.92] break-words">
      Building<br />infrastructure<br /><span class="text-primary transition-colors duration-300">that scales</span>.
    </h1>
    <p class="mt-4 text-sm md:text-[15px] text-muted-foreground/75 max-w-md leading-relaxed">
      Technical blog on infrastructure, homelab, and automation â€” and the person behind it. For people who run systems.
    </p>
    <div class="flex flex-wrap items-center gap-4 mt-6">
      <Link href="/blog" class="btn-neo-primary" aria-label="Read the blog">
        Read the blog
        <Icon name="lucide:arrow-right" class="btn-neo-icon" aria-hidden="true" />
      </Link>
      <Link href="/about" class="btn-neo-outline" aria-label="About me">
        <Icon name="lucide:user" class="btn-neo-icon" aria-hidden="true" />
        About me
      </Link>
    </div>
  </div>
  <!-- Lottie: loaded by URL (cacheable, no inline JSON) -->
  <div class="bento-identity__image overflow-hidden relative">
    <div class="hero-img-inner relative w-full h-full">
      <div
        class="hero-img-frame"
        id="hero-lottie"
        data-lottie-src={lottieSrc}
        aria-label="Robert Melcher in datacenter"
      />
    </div>
  </div>
</div>

<script>
  import lottie from 'lottie-web'

  const el = document.getElementById('hero-lottie')
  const src = el?.getAttribute('data-lottie-src')
  if (el && src) {
    const anim = lottie.loadAnimation({
      container: el,
      renderer: 'svg',
      loop: true,
      autoplay: true,
      path: src,
      initialSegment: [1, 22],
    })
    anim.setSpeed(1)
  }
</script>
