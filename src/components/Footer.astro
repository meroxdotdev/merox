---
import { SOCIAL_LINKS, NAV_LINKS } from '@/consts'
import SocialIcons from './SocialIcons.astro'
import Link from '@/components/Link.astro'
import Newsletter from './react/Newsletter'
import { ErrorBoundary } from './react/ErrorBoundary'

const isExternalLink = (href: string) => {
  return href.startsWith('http')
}
---

<footer class="mt-16 pt-16 border-t border-border/50 pb-16 bg-background/50 backdrop-blur-sm">
  <div class="mx-auto max-w-3xl px-4">
    <div class="flex flex-col gap-20">
      <!-- Newsletter Section -->
      <div class="flex flex-col md:flex-row md:items-center justify-between gap-x-16 gap-y-8">
        <div class="space-y-2">
          <div class="text-[8px] font-black uppercase tracking-[0.2em] text-primary">Newsletter</div>
          <h2 class="text-2xl font-black tracking-tighter uppercase text-foreground leading-none">Stay Updated.</h2>
          <p class="text-[11px] text-muted-foreground leading-relaxed max-w-[240px]">
            Infrastructure and DevOps insights for engineers. Join 2,000+ others.
          </p>
        </div>
        <div class="flex-1 max-w-sm">
          <ErrorBoundary client:load transition:persist="newsletter-footer">
            <Newsletter client:load />
          </ErrorBoundary>
        </div>
      </div>

      <!-- Links Grid -->
      <div class="grid grid-cols-2 md:grid-cols-3 gap-12 pt-12 border-t border-border/20">
        <!-- Navigation -->
        <div class="space-y-4">
          <h4 class="text-[10px] font-black uppercase tracking-widest text-muted-foreground/60">Explore</h4>
          <nav class="flex flex-col gap-2">
            {NAV_LINKS.map((item) => (
              <Link 
                href={item.href} 
                class="text-xs font-bold text-foreground hover:text-primary transition-colors tracking-tight"
              >
                {item.label}
              </Link>
            ))}
          </nav>
        </div>

        <!-- Legal -->
        <div class="space-y-4">
          <h4 class="text-[10px] font-black uppercase tracking-widest text-muted-foreground/60">Legal</h4>
          <nav class="flex flex-col gap-2 text-xs">
            <Link href="/privacy" class="text-muted-foreground font-medium hover:text-primary transition-colors">
              Privacy
            </Link>
            <Link href="/terms" class="text-muted-foreground font-medium hover:text-primary transition-colors">
              Terms
            </Link>
          </nav>
        </div>

        <!-- Connect -->
        <div class="space-y-4">
          <h4 class="text-[10px] font-black uppercase tracking-widest text-muted-foreground/60">Connect</h4>
          <div class="flex flex-col gap-2">
            <SocialIcons links={SOCIAL_LINKS} />
          </div>
        </div>
      </div>

      <!-- Bottom Bar -->
      <div class="flex flex-col sm:flex-row justify-between items-center gap-4 text-[10px] font-medium text-muted-foreground/60 border-t border-border/10 pt-8">
        <div>
          &copy; {new Date().getFullYear()} Robert Melcher.
        </div>
        <div class="flex items-center gap-4">
          <Link href="https://github.com/meroxdotdev/merox-erudite" external class="hover:text-primary transition-colors">
            merox-erudite theme
          </Link>
        </div>
      </div>
    </div>
  </div>
</footer>
