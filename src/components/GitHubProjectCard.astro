---
import Link from '@/components/Link.astro'
import { Badge } from '@/components/ui/badge'
import { Icon } from 'astro-icon/components'
import type { GitHubRepo } from '@/lib/github'

interface Props {
  repo: GitHubRepo
}

const { repo } = Astro.props
---

<div
  class="group relative rounded-xl border border-border/70 bg-card/80 p-6 transition-all duration-300 hover:border-primary/30 hover:bg-card hover:shadow-lg hover:-translate-y-0.5"
>
  <Link
    href={repo.html_url}
    class="flex flex-col gap-4"
    external
  >
    <div class="flex items-start justify-between gap-4">
      <div class="flex-1 min-w-0">
        <div class="flex items-center gap-2 mb-2">
          <Icon name="lucide:github" class="size-5 text-muted-foreground shrink-0" />
          <h3 class="text-xl font-bold leading-tight text-foreground group-hover:text-primary transition-colors truncate">
            {repo.name}
          </h3>
        </div>
        {repo.description && (
          <p class="text-sm text-muted-foreground/90 leading-relaxed line-clamp-2 mb-4">
            {repo.description}
          </p>
        )}
      </div>
      <Icon 
        name="lucide:arrow-up-right" 
        class="size-5 text-muted-foreground/30 group-hover:text-primary group-hover:translate-x-0.5 group-hover:-translate-y-0.5 transition-all duration-300 shrink-0 mt-1" 
      />
    </div>

    <div class="flex flex-wrap items-center gap-4 pt-3 border-t border-border/40">
      {repo.language && (
        <div class="flex items-center gap-1.5 text-xs text-muted-foreground/80">
          <span class="size-3 rounded-full bg-primary/20 border border-primary/30"></span>
          <span>{repo.language}</span>
        </div>
      )}
      
      <div class="flex items-center gap-1.5 text-xs text-muted-foreground/80">
        <Icon name="lucide:star" class="size-3.5" />
        <span class="font-medium">{repo.stargazers_count.toLocaleString()}</span>
      </div>
      
      <div class="flex items-center gap-1.5 text-xs text-muted-foreground/80">
        <Icon name="lucide:git-fork" class="size-3.5" />
        <span class="font-medium">{repo.forks_count.toLocaleString()}</span>
      </div>
    </div>

    {repo.topics && repo.topics.length > 0 && (
      <div class="flex flex-wrap gap-2 pt-2">
        {repo.topics.slice(0, 5).map((topic) => (
          <Badge variant="muted" class="text-xs">
            {topic}
          </Badge>
        ))}
        {repo.topics.length > 5 && (
          <Badge variant="muted" class="text-xs">
            +{repo.topics.length - 5}
          </Badge>
        )}
      </div>
    )}
  </Link>
</div>
